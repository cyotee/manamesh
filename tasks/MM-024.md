# Task MM-024: MTG Game Module

**Repo:** ManaMesh
**Status:** Blocked
**Created:** 2026-01-21
**Dependencies:** MM-019, MM-020
**Worktree:** `feature/game-mtg`

---

## Description

Implement the Magic: The Gathering game module. This is the most complex game, validating the full capability of the module system.

## Dependencies

- MM-019: Core Game Module Interface
- MM-020: Deck Plugin for boardgame.io

## User Stories

### US-MM-024.1: MTG Game Play

As a player, I want to play Magic: The Gathering so that I can validate complex TCG mechanics.

**Acceptance Criteria:**
- [ ] Module exports boardgame.io Game object
- [ ] MTG card schema (MTGCard extends CoreCard)
- [ ] Mana system (5 colors + colorless)
- [ ] Card types: Land, Creature, Instant, Sorcery, Enchantment, Artifact, Planeswalker
- [ ] Combat system with attackers/blockers
- [ ] Life total tracking
- [ ] Zones: library, hand, battlefield, graveyard, exile, command, stack
- [ ] Zone features: library search (tutor), peek (scry)
- [ ] Tap/untap for cards and lands
- [ ] Counter support (+1/+1, loyalty, etc.)
- [ ] Tests cover game flow

## Technical Details

### Card Schema

```typescript
interface MTGCard extends CoreCard {
  manaCost?: string;
  types: string[];          // ['Creature', 'Artifact']
  subtypes?: string[];      // ['Elf', 'Warrior']
  supertypes?: string[];    // ['Legendary', 'Snow']
  power?: number;
  toughness?: number;
  loyalty?: number;
  oracleText?: string;
  set: string;
  collectorNumber: string;
  colors: ('W' | 'U' | 'B' | 'R' | 'G')[];
}
```

### Zones

| Zone | Visibility | Ordered | Features |
|------|------------|---------|----------|
| library | hidden | yes | search, shuffle, peek |
| hand | owner-only | no | - |
| battlefield | public | no | tap/untap |
| graveyard | public | yes | - |
| exile | public | no | - |
| command | public | no | - |
| stack | public | yes | - |

### Phases

1. Beginning (untap, upkeep, draw)
2. First Main
3. Combat (beginning, declare attackers, declare blockers, damage, end)
4. Second Main
5. End (end step, cleanup)

## Files to Create/Modify

**New:**
- `packages/frontend/src/game/modules/mtg/index.ts`
- `packages/frontend/src/game/modules/mtg/types.ts`
- `packages/frontend/src/game/modules/mtg/game.ts`
- `packages/frontend/src/game/modules/mtg/mana.ts` - Mana system
- `packages/frontend/src/game/modules/mtg/combat.ts` - Combat logic

**Tests:**
- `packages/frontend/src/game/modules/mtg/game.test.ts`

## Completion Criteria

- [ ] All acceptance criteria met
- [ ] Basic game flow works
- [ ] Combat system functional
- [ ] Tests pass
- [ ] Build succeeds

---

**When complete, output:** `<promise>TASK_COMPLETE</promise>`

**If blocked, output:** `<promise>TASK_BLOCKED: [reason]</promise>`
