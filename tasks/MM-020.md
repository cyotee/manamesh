# Task MM-020: Deck Plugin for boardgame.io

**Repo:** ManaMesh
**Status:** Blocked
**Created:** 2026-01-21
**Dependencies:** MM-017, MM-019
**Worktree:** `feature/deck-plugin`

---

## Description

Create a boardgame.io plugin that provides shared deck operations: shuffle, draw, deal, peek, search. This plugin will be used by all game modules.

## Dependencies

- MM-017: Set Up boardgame.io Fork Submodules
- MM-019: Core Game Module Interface

## User Stories

### US-MM-020.1: Deck Operations Plugin

As a game module developer, I want a deck plugin so that I don't have to reimplement common card operations.

**Acceptance Criteria:**
- [ ] Plugin follows boardgame.io plugin API
- [ ] Implements shuffle() - randomize deck order
- [ ] Implements draw(n) - draw n cards from top
- [ ] Implements deal(n, players) - distribute cards to players
- [ ] Implements peek(n) - view top n cards without removing
- [ ] Implements search(predicate) - find cards matching criteria
- [ ] Implements moveCard(from, to, cardId) - move between zones
- [ ] Works with shared decks (Poker) and per-player decks (War)
- [ ] Tests cover all operations
- [ ] Build succeeds

## Technical Details

### Plugin Structure

```typescript
import { Plugin } from 'boardgame.io';

export const DeckPlugin: Plugin = {
  name: 'deck',

  setup: ({ G }) => ({
    // Initialize deck state
  }),

  api: ({ G, ctx }) => ({
    shuffle: (zoneId: string) => { ... },
    draw: (zoneId: string, n: number) => { ... },
    deal: (zoneId: string, n: number, players: string[]) => { ... },
    peek: (zoneId: string, n: number) => { ... },
    search: (zoneId: string, predicate: (card) => boolean) => { ... },
    moveCard: (from: string, to: string, cardId: string) => { ... },
  }),
};
```

## Files to Create/Modify

**New:**
- `packages/frontend/src/game/plugins/deck.ts` - Deck plugin
- `packages/frontend/src/game/plugins/index.ts` - Exports

**Tests:**
- `packages/frontend/src/game/plugins/deck.test.ts`

## Completion Criteria

- [ ] All acceptance criteria met
- [ ] Plugin integrates with boardgame.io
- [ ] All deck operations work correctly
- [ ] Tests pass
- [ ] Build succeeds

---

**When complete, output:** `<promise>TASK_COMPLETE</promise>`

**If blocked, output:** `<promise>TASK_BLOCKED: [reason]</promise>`
