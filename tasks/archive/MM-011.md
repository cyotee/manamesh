# Task MM-011: Confirm/Document Runtime Support for libp2p

**Repo:** ManaMesh
**Status:** Ready
**Created:** 2026-01-21
**Dependencies:** MM-003
**Worktree:** `feature/runtime-compat`
**Origin:** Code review suggestion from MM-003

---

## Description

Address the `Promise.withResolvers is not a function` error that occurs during tests. Document supported browser/Node versions and ensure local dev/test environment is compatible with libp2p dependencies.

(Created from code review of MM-003 - Suggestion 3)

## Dependencies

- MM-003: libp2p DHT Discovery (parent task)

## Problem Details

During test runs, DHT initialization logs:
```
Promise.withResolvers is not a function
```

Tests pass because they assert graceful failure, but this indicates a compatibility issue. `Promise.withResolvers` requires Node 22+ or modern browsers.

## User Stories

### US-MM-011.1: Runtime Compatibility

As a developer, I want clear documentation of supported runtimes so that the build is reliable across environments.

**Acceptance Criteria:**
- [ ] Document minimum Node version in package.json engines field
- [ ] Document supported browser versions in README or docs
- [ ] Either bump Node version, add polyfill, or pin libp2p versions
- [ ] Tests run without compatibility warnings
- [ ] Tests pass
- [ ] Build succeeds

## Potential Solutions

1. **Bump Node version** - Update to Node 22+ if all team members can upgrade
2. **Add polyfill** - Polyfill `Promise.withResolvers` in test environment
3. **Pin dependencies** - Use older libp2p version that doesn't require it

## Files to Create/Modify

**Modified Files:**
- `packages/frontend/package.json` (version bumps/pins)
- `packages/frontend/vitest.config.ts` (if polyfill needed)
- `README.md` or docs (runtime requirements)

## Inventory Check

Before starting, verify:
- [ ] Current Node version in use
- [ ] Which libp2p dependency requires Promise.withResolvers

## Completion Criteria

- [ ] All acceptance criteria met
- [ ] Runtime requirements documented
- [ ] No compatibility warnings during tests
- [ ] Tests pass
- [ ] Build succeeds

---

**When complete, output:** `<promise>TASK_COMPLETE</promise>`

**If blocked, output:** `<promise>TASK_BLOCKED: [reason]</promise>`
