# Task MM-027: Asset Pack Manifest Parser

**Repo:** ManaMesh
**Status:** Ready
**Created:** 2026-01-21
**Dependencies:** None
**Worktree:** `feature/asset-manifest-parser`

---

## Description

Implement the asset pack manifest parser that reads and validates manifest.json files according to the Asset Pack Format specification in the PRD.

## Dependencies

None

## User Stories

### US-MM-027.1: Parse Asset Pack Manifests

As a developer, I want to parse asset pack manifests so that I can load card assets dynamically.

**Acceptance Criteria:**
- [ ] Parse root manifest.json structure
- [ ] Parse card manifest entries
- [ ] Validate manifest schema (required fields, types)
- [ ] Handle nested manifests (subdirectory references)
- [ ] Return typed AssetPackManifest object
- [ ] Error handling for malformed manifests
- [ ] Tests cover parsing and validation

### US-MM-027.2: Manifest Types

As a developer, I want TypeScript types for manifests so that I have type safety.

**Acceptance Criteria:**
- [ ] AssetPackManifest interface
- [ ] CardManifestEntry interface
- [ ] Validation error types
- [ ] Export from package

## Technical Details

### Manifest Structure (from PRD)

```typescript
interface AssetPackManifest {
  name: string;
  version: string;
  game: string;                    // 'mtg', 'lorcana', 'onepiece', 'poker', 'war'
  cards?: CardManifestEntry[];
  sets?: SetReference[];           // References to subdirectory manifests
}

interface CardManifestEntry {
  id: string;                      // Unique card identifier
  name: string;
  front: string;                   // Relative path to front image
  back?: string;                   // Relative path to back image (optional)
  metadata?: Record<string, unknown>;
}

interface SetReference {
  name: string;
  path: string;                    // Relative path to subdirectory manifest
}
```

### Functions to Implement

```typescript
// Parse and validate a manifest
function parseManifest(json: unknown): Result<AssetPackManifest, ValidationError[]>;

// Validate manifest schema
function validateManifest(manifest: unknown): ValidationError[];

// Resolve nested manifests into flat card list
function resolveNestedManifests(
  root: AssetPackManifest,
  loader: (path: string) => Promise<unknown>
): Promise<CardManifestEntry[]>;
```

## Files to Create/Modify

**New:**
- `packages/frontend/src/assets/manifest/types.ts` - Manifest types
- `packages/frontend/src/assets/manifest/parser.ts` - Parser implementation
- `packages/frontend/src/assets/manifest/validator.ts` - Schema validation
- `packages/frontend/src/assets/manifest/index.ts` - Exports

**Tests:**
- `packages/frontend/src/assets/manifest/parser.test.ts`
- `packages/frontend/src/assets/manifest/validator.test.ts`

## Completion Criteria

- [ ] All acceptance criteria met
- [ ] Parser handles valid manifests
- [ ] Validator catches invalid manifests
- [ ] Nested manifest resolution works
- [ ] Tests pass
- [ ] Build succeeds

---

**When complete, output:** `<promise>TASK_COMPLETE</promise>`

**If blocked, output:** `<promise>TASK_BLOCKED: [reason]</promise>`
